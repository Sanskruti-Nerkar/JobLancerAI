<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JobLancer ‚Äî Agentic AI Job Assistant</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1220;--card:#0f1724;--muted:#9aa6bb;--accent1:#4f9cf7;--accent2:#7b61ff;--accent3:#ff6b81;--accent4:#26d07b;--glass:rgba(255,255,255,0.05);--radius:14px;--ease:cubic-bezier(.16,.84,.24,1);color-scheme:dark;
    }
    body.light{
      --bg:#f8f9fc;--card:#ffffff;--muted:#4a5668;--glass:rgba(0,0,0,0.05);color-scheme:light;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui;-webkit-font-smoothing:antialiased;line-height:1.5;background:radial-gradient(circle at 20% 30%,#101c33,#050812 90%);color:#eaf2ff;overflow-x:hidden}

    /* Netflix-like intro */
    .intro{position:fixed;inset:0;display:grid;place-items:center;background:black;z-index:9999;animation:bgFade 3s forwards}
    @keyframes bgFade{0%{opacity:1}90%{opacity:1}100%{opacity:0;visibility:hidden}}
    .logo-pop{font-size:80px;font-weight:900;background:linear-gradient(90deg,#4f9cf7,#ff6b81,#7b61ff);-webkit-background-clip:text;background-clip:text;color:transparent;opacity:0;animation:popIn 2s 0.2s forwards ease-in-out}
    @keyframes popIn{0%{transform:scale(0.4);opacity:0}50%{transform:scale(1.3);opacity:1}70%{transform:scale(0.9)}100%{transform:scale(1);opacity:1}}
    .sound{position:absolute;bottom:80px;opacity:0;animation:sound 3s ease-in forwards}
    @keyframes sound{0%{opacity:0;transform:scale(0)}60%{opacity:1;transform:scale(1.3)}100%{opacity:0;transform:scale(1.6)}}

    /* Ticker */
    .ticker{background:linear-gradient(90deg,rgba(255,255,255,0.1),rgba(255,255,255,0.03));padding:8px 12px;color:var(--muted);white-space:nowrap;overflow:hidden;position:sticky;top:0;z-index:2}
    .ticker span{display:inline-block;animation:marquee 14s linear infinite}
    @keyframes marquee{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}

    header{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;position:sticky;top:0;background:rgba(0,0,0,0.3);backdrop-filter:blur(8px);z-index:2}
    .brand{display:flex;align-items:center;gap:10px}
    .brand .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#4f9cf7,#ff6b81);display:grid;place-items:center;font-weight:900;font-size:22px;color:white;animation:pulse 2s infinite}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.06)}}
    .brand h1{font-size:20px}

    nav a{color:var(--muted);text-decoration:none;margin:0 10px;font-weight:600;transition:color .3s}
    nav a:hover{color:#fff}
    .controls{display:flex;align-items:center;gap:10px}
    .theme-toggle{width:42px;height:42px;border-radius:50%;background:var(--glass);display:grid;place-items:center;cursor:pointer;transition:transform .3s}
    .theme-toggle:hover{transform:rotate(20deg)}
    .btn{padding:10px 16px;border:none;border-radius:10px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;font-weight:700;cursor:pointer;transition:transform .2s}
    .btn:hover{transform:scale(1.05)}

    main{max-width:1100px;margin:40px auto;padding:20px;display:flex;flex-direction:column;gap:40px}
    section{background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);border-radius:16px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,0.4);transition:transform .4s,box-shadow .4s}
    section:hover{transform:translateY(-5px);box-shadow:0 20px 50px rgba(0,0,0,0.5)}

    #about p{color:var(--muted);margin-top:10px}
    #upload label{display:block;margin:10px 0;color:var(--muted)}
    textarea,input[type=text],input[type=number]{width:100%;border:none;border-radius:10px;padding:10px;background:rgba(255,255,255,0.05);color:inherit;margin-top:6px}
    .upload-box{border:2px dashed rgba(255,255,255,0.1);padding:30px;text-align:center;border-radius:14px;transition:all .3s ease;cursor:pointer}
    .upload-box.drag{background:rgba(79,156,247,0.1);border-color:var(--accent1);transform:scale(1.02)}
    form{display:flex;flex-direction:column;gap:20px;margin-top:20px}
    .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px}
    .field label{font-size:14px;margin-bottom:4px;color:var(--muted)}
    .field input,.field select,textarea{border:1px solid rgba(255,255,255,0.05)}
    .toggle-row{display:flex;flex-wrap:wrap;gap:16px}
    .toggle-row label{display:flex;align-items:center;gap:8px;font-weight:600;color:var(--muted)}
    .status-card{border:1px solid rgba(255,255,255,0.1);border-radius:14px;padding:18px;background:rgba(255,255,255,0.02);margin-top:20px}
    .status-card[data-variant="error"]{border-color:#ff6b81;background:rgba(255,107,129,0.08)}
    .status-card[data-variant="success"]{border-color:#26d07b;background:rgba(38,208,123,0.08)}
    .status-card h3{margin-bottom:6px;font-size:18px}
    .status-card ul{margin:10px 0 0 20px;color:var(--muted)}
    .hidden{display:none!important}
    #results{display:flex;flex-direction:column;gap:24px;margin-top:24px}
    .results-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}
    .match-card{padding:18px;border-radius:16px;background:linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0));border:1px solid rgba(255,255,255,0.05);box-shadow:0 10px 30px rgba(0,0,0,0.4)}
    .match-card h3{margin-bottom:6px}
    .match-card p{color:var(--muted);font-size:14px;margin:4px 0}
    .scores{margin-top:12px;font-size:14px}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
    .chip{padding:4px 10px;border-radius:999px;background:rgba(255,255,255,0.08);font-size:12px}
    .application-summary{border:1px solid rgba(79,156,247,0.4);border-radius:16px;padding:18px;background:rgba(79,156,247,0.08)}
    .resume-summary{border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:18px;background:rgba(255,255,255,0.02)}
    .file-hint{font-size:14px;color:var(--muted);margin-top:8px}
    .btn[disabled]{opacity:0.6;cursor:not-allowed}
    footer{text-align:center;padding:20px;color:var(--muted)}

    .reveal{opacity:0;transform:translateY(20px);transition:all .8s ease}
    .reveal.visible{opacity:1;transform:translateY(0)}
  </style>
</head>
<body>
  <div class="intro">
    <div class="logo-pop">JL</div>
    <div class="sound">üîä</div>
  </div>
  <div class="ticker"><span>‚ö†Ô∏è Keep your LinkedIn credentials ready for seamless application automation.</span></div>
  <header>
    <div class="brand"><div class="logo">JL</div><h1>JobLancer</h1></div>
    <nav>
      <a href="#about">About</a>
      <a href="#upload">Upload Resume</a>
      <a href="#contact">Contact</a>
    </nav>
    <div class="controls">
      <div class="theme-toggle" id="themeToggle">üåó</div>
      <button class="btn">Get Started</button>
    </div>
  </header>

  <main>
    <section id="about" class="reveal">
      <h2>About JobLancer</h2>
      <p>JobLancer is an agentic AI system that automates job search ‚Äî scraping listings, filtering with NLP, generating personalized cover letters via GPT, and even submitting applications. It saves up to 70% of manual effort.</p>
    </section>

    <section id="upload" class="reveal">
      <h2>Run LinkedIn Agent</h2>
      <p style="color:var(--muted);margin-top:6px">Provide your search filters, upload a resume, and let the backend scrape, match, and optionally auto-apply using LinkedIn Easy Apply.</p>
      <form id="jobForm">
        <div class="upload-box" id="dropzone">
          <div style="font-size:40px">üìÑ</div>
          <p>Drop your PDF resume here or click to browse</p>
          <p class="file-hint" id="fileNameHint">No file selected</p>
          <input type="file" id="fileInput" name="resume" accept=".pdf" hidden>
        </div>
        <div class="form-grid">
          <div class="field">
            <label for="jobTitle">Job Title *</label>
            <input type="text" id="jobTitle" name="job_title" placeholder="AI Engineer, Python Developer..." required>
          </div>
          <div class="field">
            <label for="jobLocation">Location (Optional)</label>
            <input type="text" id="jobLocation" name="location" placeholder="Mumbai, Remote">
          </div>
          <div class="field">
            <label for="pages">LinkedIn Pages (1-5)</label>
            <input type="number" id="pages" name="num_pages" min="1" max="5" value="2">
          </div>
          <div class="field">
            <label for="topN">Top Matches</label>
            <input type="number" id="topN" name="top_n" min="5" max="25" value="15">
          </div>
          <div class="field">
            <label for="minScoreFilter">Minimum Match Score (0-1)</label>
            <input type="number" step="0.05" id="minScoreFilter" name="min_score_filter" min="0" max="1" value="0.25">
          </div>
        </div>
        <div class="toggle-row">
          <label><input type="checkbox" id="fetchDetails" name="fetch_details"> Detailed scraping (slower)</label>
          <label><input type="checkbox" id="autoApply" name="auto_apply"> Auto-apply once matches are ready</label>
        </div>
        <div id="applyConfig" class="form-grid hidden">
          <div class="field">
            <label for="applyScore">Auto-apply score threshold (0-1)</label>
            <input type="number" step="0.05" id="applyScore" name="apply_score_threshold" min="0" max="1" value="0.6">
          </div>
          <div class="field">
            <label for="applyLimit">Max Easy Apply submissions</label>
            <input type="number" id="applyLimit" name="apply_limit" min="1" max="30" value="10">
          </div>
        </div>
        <button class="btn" id="runBtn" type="submit">Search & Match Jobs</button>
        <p class="file-hint">Chrome will open so you can log into LinkedIn. Follow the prompts printed in the terminal window running this app.</p>
      </form>
      <div id="statusPanel" class="status-card hidden">
        <h3 id="statusTitle">Status</h3>
        <p id="statusMessage"></p>
        <ul id="statusSteps"></ul>
      </div>
      <div id="results"></div>
    </section>

    <section id="contact" class="reveal">
      <h2>Contact Us</h2>
      <p>Got questions or feedback? Reach out to us!</p>
      <input type="text" placeholder="Your Name">
      <input type="text" placeholder="Your Email">
      <textarea rows="4" placeholder="Message"></textarea>
      <div style="margin-top:10px"><button class="btn">Send</button></div>
    </section>
  </main>
  <footer>¬© 2025 JobLancer ‚Äî AI-driven job automation platform.</footer>

  <script>
    const observer=new IntersectionObserver(entries=>{entries.forEach(e=>{if(e.isIntersecting)e.target.classList.add('visible');});},{threshold:0.1});
    document.querySelectorAll('.reveal').forEach(el=>observer.observe(el));

    const toggle=document.getElementById('themeToggle');let light=false;toggle.onclick=()=>{light=!light;document.body.classList.toggle('light',light)};

    const dropzone=document.getElementById('dropzone');
    const fileInput=document.getElementById('fileInput');
    const fileNameHint=document.getElementById('fileNameHint');
    dropzone.addEventListener('click',()=>fileInput.click());
    const prevent=e=>{e.preventDefault();e.stopPropagation();};
    ['dragenter','dragover'].forEach(ev=>dropzone.addEventListener(ev,e=>{prevent(e);dropzone.classList.add('drag');}));
    ['dragleave','drop'].forEach(ev=>dropzone.addEventListener(ev,e=>{prevent(e);dropzone.classList.remove('drag');}));
    dropzone.addEventListener('drop',e=>{const file=e.dataTransfer.files[0];if(file){fileInput.files=e.dataTransfer.files;updateFileHint(file);}});
    fileInput.addEventListener('change',()=>{if(fileInput.files[0])updateFileHint(fileInput.files[0]);});
    function updateFileHint(file){fileNameHint.textContent=file?file.name:'No file selected';}

    const jobForm=document.getElementById('jobForm');
    const runBtn=document.getElementById('runBtn');
    const statusPanel=document.getElementById('statusPanel');
    const statusTitle=document.getElementById('statusTitle');
    const statusMessage=document.getElementById('statusMessage');
    const statusSteps=document.getElementById('statusSteps');
    const resultsNode=document.getElementById('results');
    const autoApply=document.getElementById('autoApply');
    const applyConfig=document.getElementById('applyConfig');
    autoApply.addEventListener('change',()=>{applyConfig.classList.toggle('hidden',!autoApply.checked);});

    function setStatus({title='Status',message='',variant='info',steps=[]}){
      statusPanel.classList.remove('hidden');
      statusPanel.dataset.variant=variant;
      statusTitle.textContent=title;
      statusMessage.textContent=message;
      statusSteps.innerHTML=steps.map(step=>`<li>${step}</li>`).join('');
    }

    function clearStatus(){statusPanel.classList.add('hidden');statusSteps.innerHTML='';statusMessage.textContent='';}

    function formatPercent(value){return `${Math.round((value||0)*100)}%`;}

    jobForm.addEventListener('submit',async e=>{
      e.preventDefault();
      if(!fileInput.files.length){
        setStatus({title:'Resume missing',message:'Upload a PDF resume before running the agent.',variant:'error'});
        return;
      }
      const formData=new FormData(jobForm);
      formData.set('resume',fileInput.files[0]);
      runBtn.disabled=true;
      resultsNode.innerHTML='';
      setStatus({
        title:'Working...',
        message:'Launching Selenium. Watch the terminal for LinkedIn login prompts.',
        steps:[
          'Allow Chrome to open and log into LinkedIn manually when prompted.',
          'Do not close the browser until the automation completes.',
          'Return here to view matches and results.'
        ]
      });
      try{
        const response=await fetch('/api/match-jobs',{method:'POST',body:formData});
        const payload=await response.json();
        if(!response.ok){
          throw new Error(payload.message||'Failed to process request.');
        }
        renderResults(payload);
        const variant=payload.status==='success'?'success':'info';
        setStatus({title:'Done',message:`Matched ${payload.matches_found||0} roles out of ${payload.jobs_found||0} scraped.`,variant,steps:payload.messages||[]});
      }catch(err){
        console.error(err);
        setStatus({title:'Error',message:err.message||'Something went wrong.',variant:'error'});
      }finally{
        runBtn.disabled=false;
      }
    });

    function renderResults(payload){
      if(payload.status==='no_jobs'){
        resultsNode.innerHTML=`<div class="status-card" data-variant="info"><h3>No jobs found</h3><p>${payload.message||'LinkedIn did not return Easy Apply jobs for your current filters.'}</p></div>`;
        return;
      }
      resultsNode.innerHTML='';
      if(payload.resume){
        resultsNode.appendChild(renderResumeSummary(payload.resume));
      }
      if(payload.application_summary){
        resultsNode.appendChild(renderApplicationSummary(payload.application_summary));
      }
      resultsNode.appendChild(renderMatches(payload.matches||[]));
    }

    function renderResumeSummary(resume){
      const card=document.createElement('div');
      card.className='resume-summary';
      const chips=(resume.technical_skills||[]).slice(0,12).map(skill=>`<span class="chip">${skill}</span>`).join('')||'<span class="chip">No skills detected</span>';
      card.innerHTML=`
        <h3>Resume Summary</h3>
        <p><strong>Name:</strong> ${resume.name||'Unknown'}</p>
        <p><strong>Email:</strong> ${resume.email||'Not detected'}</p>
        <p><strong>Experience:</strong> ${resume.years_of_experience??'N/A'} years</p>
        <div class="chips">${chips}</div>
      `;
      return card;
    }

    function renderApplicationSummary(summary){
      const card=document.createElement('div');
      card.className='application-summary';
      card.innerHTML=`
        <h3>Auto-Apply Summary</h3>
        <p>Attempted: ${summary.attempted||0}</p>
        <p>Easy Apply: ${summary.applied||0}</p>
        <p>Failed: ${summary.failed||0}</p>
        <p>Skipped: ${summary.skipped||0}</p>
        <p>Success Rate: ${(summary.success_rate||0).toFixed(1)}%</p>
      `;
      return card;
    }

    function renderMatches(matches){
      const wrapper=document.createElement('div');
      wrapper.innerHTML='<h3>Top Matches</h3>';
      if(!matches.length){
        wrapper.innerHTML+='<p style="color:var(--muted)">No matches met the threshold. Try lowering the minimum score.</p>';
        return wrapper;
      }
      const grid=document.createElement('div');
      grid.className='results-grid';
      matches.forEach((match,idx)=>{
        const card=document.createElement('div');
        card.className='match-card';
        card.innerHTML=`
          <h3>#${idx+1} ${match.title||'Role'}</h3>
          <p>${match.company||'Company'} ‚Ä¢ ${match.location||'Location'} ‚Ä¢ ${match.platform||'LinkedIn'}</p>
          <p class="scores">Match Score: <strong>${formatPercent(match.final_score)}</strong></p>
          <p class="scores">Skills: ${formatPercent(match.skills_score)} | Experience: ${formatPercent(match.experience_score)} | Title: ${formatPercent(match.title_relevance)}</p>
          <div class="chips">
            ${(match.matched_skills||[]).slice(0,5).map(skill=>`<span class="chip">‚úÖ ${skill}</span>`).join('')}
            ${(match.missing_skills||[]).slice(0,3).map(skill=>`<span class="chip">‚ö†Ô∏è ${skill}</span>`).join('')}
          </div>
          <div style="margin-top:12px">
            <a href="${match.link||'#'}" target="_blank" rel="noopener" class="btn" style="display:inline-block;padding:8px 14px;font-size:14px">Open Listing</a>
          </div>
        `;
        grid.appendChild(card);
      });
      wrapper.appendChild(grid);
      return wrapper;
    }
  </script>
</body>
</html>
